(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     74128,       1666]
NotebookOptionsPosition[     71268,       1604]
NotebookOutlinePosition[     71805,       1624]
CellTagsIndexPosition[     71762,       1621]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\:0422\:0435\:0445\:043d\:0438\:0447\:0435\:0441\:043a\:0438\:0435 \
\:0432\:0435\:0449\:0438", "Subsection",
 CellChangeTimes->{{3.846834520357806*^9, 
  3.8468345273296967`*^9}},ExpressionUUID->"a634d41f-370e-4978-b3f4-\
6d8a940d7378"],

Cell[BoxData[{
 RowBox[{"Needs", "[", "\"\<NDSolve`FEM`\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Mon", " ", "[", "prog_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Timing", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ReleaseHold", "[", "prog", "]"}], ";"}], 
       "\[IndentingNewLine]", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
       "step", ",", "\"\< / \>\"", ",", "tmax", ",", "\"\< \>\"", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ProgressIndicator", "[", 
         RowBox[{"step", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "tmax"}], "}"}]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "//", "Row"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.846834515776772*^9, 3.8468345161046896`*^9}, {
  3.846834997814378*^9, 3.8468349991259623`*^9}, {3.8468517830126095`*^9, 
  3.846851826779636*^9}, {3.846853099210747*^9, 3.8468530996169615`*^9}, {
  3.846853246640133*^9, 3.846853261982583*^9}, {3.846853308806731*^9, 
  3.8468533113533845`*^9}},
 CellLabel->
  "In[181]:=",ExpressionUUID->"fafc50c5-8f20-4fc6-ae7d-dd73a4d177fd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\:041e\:0441\:043d\:043e\:0432\:043d\:044b\:0435 \:043a\:043e\:043d\
\:0441\:0442\:0430\:043d\:0442\:044b:", "Subsection",
 CellChangeTimes->{{3.845370236350303*^9, 
  3.845370250986601*^9}},ExpressionUUID->"c2571d73-d70e-40d8-9f35-\
bfdcc719ea43"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"xmin", "xmax"}
     }], "\[NoBreak]", ")"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0", "1"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax", ":=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rate", ":=", 
   RowBox[{"{", 
    RowBox[{"V", "->", 
     RowBox[{"If", " ", "[", "\n", 
      RowBox[{
       RowBox[{
        RowBox[{"0.1", "<", "x", "<", "0.3"}], " ", "&&", " ", 
        RowBox[{"t", "<=", "1.5"}]}], ",", "\n", 
       RowBox[{"\[Gamma]", "*", 
        RowBox[{"m", "[", 
         RowBox[{"t", ",", "x"}], "]"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            FractionBox[
             RowBox[{"m", "[", 
              RowBox[{"t", ",", "x"}], "]"}], 
             RowBox[{"1", "-", 
              RowBox[{"n", "[", 
               RowBox[{"t", ",", "x"}], "]"}]}]], "]"}]}], ")"}], 
         FractionBox[
          RowBox[{"\[Gamma]", "-", "1."}], "\[Gamma]"]]}], ",", "\n", "0"}], 
      "]"}]}], "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Gamma]", ":=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"in"},
      {"ip"}
     }], "\[NoBreak]", ")"}], ":=", 
   RowBox[{"(", "\[NoBreak]", GridBox[{
      {"0.2"},
      {"0.001"}
     }], "\[NoBreak]", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"consts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ANM", "->", "0.01"}], " ", ",", 
     RowBox[{"BPM", "->", 
      RowBox[{"0.001", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"p", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "0.13"]}], "]"}]}]}], ",", 
     RowBox[{"ENP", "->", 
      RowBox[{"0.005", 
       RowBox[{"Exp", "[", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"p", "[", 
           RowBox[{"t", ",", "x"}], "]"}], "0.13"]}], "]"}]}]}]}], "}"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.844147421335171*^9, 3.844147467525486*^9}, {
   3.844151775922891*^9, 3.844151779003247*^9}, {3.844153139072816*^9, 
   3.844153141103896*^9}, 3.8441534482778788`*^9, {3.8441536916980324`*^9, 
   3.8441537463898144`*^9}, 3.844153789934928*^9, {3.844154507568112*^9, 
   3.8441545193092785`*^9}, {3.8441553543647985`*^9, 
   3.8441554342758102`*^9}, {3.844155924271934*^9, 3.844155962017359*^9}, {
   3.8441568779711685`*^9, 3.8441568870680513`*^9}, {3.844156951261492*^9, 
   3.8441569553591585`*^9}, {3.844158366832717*^9, 3.844158373873929*^9}, {
   3.844158437470149*^9, 3.8441584426921096`*^9}, 3.8441585886477413`*^9, 
   3.8441591300404825`*^9, {3.844159411439416*^9, 3.8441594118252926`*^9}, {
   3.844159595834306*^9, 3.844159597895441*^9}, {3.844159661877409*^9, 
   3.8441596721477823`*^9}, {3.8441603661169367`*^9, 3.844160434306337*^9}, {
   3.844160505029499*^9, 3.8441605330881405`*^9}, {3.8441612035383787`*^9, 
   3.844161241858596*^9}, {3.8441620355525427`*^9, 3.8441620440268965`*^9}, {
   3.844162786019374*^9, 3.844162789462635*^9}, {3.8442171411402435`*^9, 
   3.8442171971297026`*^9}, {3.844217556631649*^9, 3.8442176528707805`*^9}, {
   3.8442180616432495`*^9, 3.8442181046459475`*^9}, {3.845264194628686*^9, 
   3.8452641991645327`*^9}, {3.845264240526492*^9, 3.8452642456727223`*^9}, {
   3.845265077782874*^9, 3.8452650799222736`*^9}, {3.8452656284422674`*^9, 
   3.8452656370066013`*^9}, {3.845290250805952*^9, 3.845290264361041*^9}, {
   3.84535020359624*^9, 3.845350227551261*^9}, {3.84536428438352*^9, 
   3.8453642868745985`*^9}, {3.8453702569346952`*^9, 3.845370279676383*^9}, {
   3.8453703160197134`*^9, 3.8453703164255953`*^9}, {3.8453718554244957`*^9, 
   3.8453718579976654`*^9}, {3.845372130003393*^9, 3.8453721301663594`*^9}, {
   3.845372612122469*^9, 3.845372619814014*^9}, {3.8453731995657854`*^9, 
   3.845373199830698*^9}, {3.8453732458489685`*^9, 3.8453732463187933`*^9}, {
   3.8455406346726522`*^9, 3.8455406347686234`*^9}, {3.845545073968897*^9, 
   3.8455450803040004`*^9}, {3.84554682309242*^9, 3.845546844424621*^9}, {
   3.845546891647283*^9, 3.845546904282238*^9}, {3.8455626926081414`*^9, 
   3.8455627286363573`*^9}, {3.845562797286878*^9, 3.845562802645837*^9}, 
   3.8455647763868933`*^9, 3.8455648981267376`*^9, 3.84556503384979*^9, {
   3.845565185180932*^9, 3.8455651934302297`*^9}, {3.845654092127188*^9, 
   3.8456541081559477`*^9}, {3.845654367911484*^9, 3.8456543692635517`*^9}, {
   3.845654440586896*^9, 3.845654442079069*^9}, 3.845654493506484*^9, {
   3.845654540639189*^9, 3.84565454125445*^9}, 3.8457241697240114`*^9, {
   3.8457242105370216`*^9, 3.8457242183688593`*^9}, {3.8457243648365617`*^9, 
   3.8457243847825236`*^9}, 3.8468349782316074`*^9, {3.8468532986513534`*^9, 
   3.84685329965127*^9}, 3.8468545868100543`*^9, {3.8468593971822324`*^9, 
   3.8468594005413218`*^9}, {3.8534198294137554`*^9, 3.853419856216324*^9}, {
   3.853420789380155*^9, 3.853420794232403*^9}, {3.853421325834848*^9, 
   3.8534213271314335`*^9}, {3.85342142392342*^9, 3.8534214265675707`*^9}, {
   3.8534215040498886`*^9, 3.8534215151753287`*^9}, {3.853424040737056*^9, 
   3.853424040857027*^9}, {3.853424137987223*^9, 3.853424145082927*^9}, {
   3.853424309591326*^9, 3.8534243099191957`*^9}, 3.8534243708857384`*^9, 
   3.853424444373226*^9, {3.8534257170159807`*^9, 3.8534257212756343`*^9}, {
   3.853425797583262*^9, 3.853425797842159*^9}, {3.8534261374724503`*^9, 
   3.853426140100611*^9}, {3.853582298374915*^9, 3.853582319280385*^9}, {
   3.853582600896697*^9, 3.8535826058724127`*^9}, 3.8544597543396673`*^9, {
   3.8544598996657495`*^9, 3.8544599026970057`*^9}, {3.8545003919876738`*^9, 
   3.8545004141109095`*^9}, {3.8545006251913514`*^9, 3.854500635050709*^9}, 
   3.854501279784839*^9, 3.854531257531331*^9, {3.875841198971527*^9, 
   3.875841219847192*^9}, {3.87584131321933*^9, 3.875841321631257*^9}, {
   3.8758417196473656`*^9, 3.8758417237536964`*^9}, {3.875843508682229*^9, 
   3.8758435097158737`*^9}, 3.8758440720636024`*^9, {3.8758442306126614`*^9, 
   3.8758442357086663`*^9}, {3.875844354033245*^9, 3.8758443706357145`*^9}, {
   3.8758478906348157`*^9, 3.875847892148964*^9}, {3.8758479878463216`*^9, 
   3.8758479881201477`*^9}, 3.8758481993404856`*^9, 3.8758610592912383`*^9, 
   3.87586110124263*^9, 3.875862067956587*^9, {3.875863063482338*^9, 
   3.8758630642004747`*^9}, {3.87586520693958*^9, 3.8758652073157053`*^9}, 
   3.875866494012602*^9, {3.875956890412736*^9, 3.8759569042814226`*^9}, {
   3.8759575287777863`*^9, 3.8759575292377176`*^9}, {3.876044248503798*^9, 
   3.876044249438055*^9}, {3.8760458220662675`*^9, 3.876045822436432*^9}, 
   3.876045938942485*^9, {3.8760460356008615`*^9, 3.8760460360518913`*^9}, {
   3.8760476923119087`*^9, 3.876047745965191*^9}, {3.8760478300170135`*^9, 
   3.8760478361224613`*^9}, {3.876047901731409*^9, 3.8760479110827103`*^9}, {
   3.8760481312932816`*^9, 3.876048132364823*^9}, 3.876048898005273*^9, 
   3.876048943417245*^9, 3.8760489799964476`*^9, {3.876049056622388*^9, 
   3.876049057062893*^9}, {3.8760500526809545`*^9, 3.876050126240389*^9}, {
   3.8760506684234095`*^9, 3.876050681260713*^9}, {3.8760509706735587`*^9, 
   3.87605097365921*^9}, {3.8760510392256956`*^9, 3.876051055738784*^9}, {
   3.876051149820937*^9, 3.8760511506948867`*^9}, 3.8762796810085497`*^9, {
   3.876280249909052*^9, 3.876280250362977*^9}, {3.8762836165935793`*^9, 
   3.8762836179854593`*^9}, {3.876284032961933*^9, 3.876284046374215*^9}, 
   3.8763623957389536`*^9, {3.8764657112546062`*^9, 3.876465712306607*^9}, {
   3.876466310616893*^9, 3.8764663116241045`*^9}, {3.876467592144384*^9, 
   3.876467593457884*^9}, {3.8764676406342044`*^9, 3.8764676408502045`*^9}, {
   3.876469988520219*^9, 3.8764700028343563`*^9}, {3.8764700409788194`*^9, 
   3.876470041540978*^9}},
 CellLabel->
  "In[183]:=",ExpressionUUID->"9bb19146-52b8-4688-8de0-832643d7a09f"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0423\:0440\:0430\:0432\:043d\:0435\:043d\:0438\:044f", "Subsection",
 CellChangeTimes->{{3.844153511018799*^9, 3.8441535142481103`*^9}, {
  3.846845819792838*^9, 
  3.846845826526867*^9}},ExpressionUUID->"ecdb4270-0e29-4cf8-a85f-\
0106df86b174"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "\n", 
   RowBox[{
   "\:041e\:0441\:043d\:043e\:0432\:043d\:0430\:044f", " ", 
    "\:0441\:0438\:0441\:0442\:0435\:043c\:0430"}], "\n", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"eq", ":=", 
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"t", ",", " ", "x"}], "]"}], ",", " ", 
             RowBox[{"{", "t", "}"}]}], "]"}], " ", "+", " ", 
           RowBox[{"Div", "[", 
            RowBox[{"jN", ",", " ", 
             RowBox[{"{", "x", "}"}]}], "]"}]}], " ", "==", " ", 
          "\[CapitalGamma]n"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"p", "[", 
              RowBox[{"t", ",", " ", "x"}], "]"}], ",", " ", 
             RowBox[{"{", "t", "}"}]}], "]"}], " ", "+", " ", 
           RowBox[{"Div", "[", 
            RowBox[{"jP", ",", " ", 
             RowBox[{"{", "x", "}"}]}], "]"}]}], " ", "==", " ", 
          "\[CapitalGamma]p"}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Div", "|", "D", "|", "Grad"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
   "(*", "\n", "\:041f\:043e\:0442\:043e\:043a\:0438", "\[IndentingNewLine]", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"fluxes", ":=", 
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jN", "->", "\n", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"t", ",", "x"}], "]"}], " ", 
               RowBox[{"{", 
                RowBox[{"{", "ANM", "}"}], "}"}]}], ")"}], ".", 
             TemplateBox[{
               RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], 
               RowBox[{"{", "x", "}"}]},
              "Grad"]}]}], "\n", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "ENP", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"n", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}], "\n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "ANM", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"m", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}], "\n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "ENP", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"p", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}]}]}], "\n", ",", "\[IndentingNewLine]", 
         RowBox[{"jP", "\[Rule]", "\n", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"m", "[", 
                RowBox[{"t", ",", "x"}], "]"}], " ", 
               RowBox[{"{", 
                RowBox[{"{", "BPM", "}"}], "}"}]}], ")"}], ".", 
             TemplateBox[{
               RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], 
               RowBox[{"{", "x", "}"}]},
              "Grad"]}]}], "\n", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "ENP", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"p", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}], "\n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "BPM", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"m", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}], "\n", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"p", "[", 
               RowBox[{"t", ",", "x"}], "]"}], " ", 
              RowBox[{"{", 
               RowBox[{"{", "ENP", "}"}], "}"}]}], ")"}], ".", 
            TemplateBox[{
              RowBox[{"n", "[", 
                RowBox[{"t", ",", "x"}], "]"}], 
              RowBox[{"{", "x", "}"}]},
             "Grad"]}]}]}]}], "\[IndentingNewLine]", "}"}], ",", 
       RowBox[{"Div", "|", "D", "|", "Grad"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", "\n", 
    RowBox[{
    "\:0413\:0440\:0430\:043d\:0438\:0447\:043d\:044b\:0435", " ", 
     "\:043f\:043e\:0442\:043e\:043a\:0438"}], "\[IndentingNewLine]", "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"bound", ":=", 
     RowBox[{"Inactivate", "[", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[CapitalGamma]n", "->", 
          RowBox[{"NeumannValue", "[", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"t", ",", "x"}], "]"}], " ", "ANM"}], ")"}]}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "in"}], ")"}], "*", 
              "10"}], "\n", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "ENP"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "in"}], ")"}], "*", 
              "10"}], "\n", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "ANM"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "in", "-", "ip"}], ")"}]}], ")"}], "*", 
              "10"}], "\n", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "ENP"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "ip"}], ")"}], "*", 
              "10"}]}], "\n", ",", 
            RowBox[{"x", "==", "0"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"\[CapitalGamma]p", "->", 
          RowBox[{"NeumannValue", "[", "\n", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"m", "[", 
                  RowBox[{"t", ",", "x"}], "]"}], " ", "BPM"}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "ip"}], ")"}], "*", 
              "10"}], "\n", "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "ENP"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "ip"}], ")"}], "*", 
              "10"}], "\n", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "BPM"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"m", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", 
                RowBox[{"(", 
                 RowBox[{"1", "-", "in", "-", "ip"}], ")"}]}], ")"}], "*", 
              "10"}], "\n", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"p", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], " ", "ENP"}], ")"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"t", ",", "x"}], "]"}], "-", "in"}], ")"}], "*", 
              "10"}]}], "\n", ",", 
            RowBox[{"x", "==", "0"}]}], "]"}]}]}], "\n", "}"}], ",", 
       RowBox[{"Div", "|", "D", "|", "Grad"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "\n", 
    RowBox[{
    "\:041d\:0430\:0447\:0430\:043b\:044c\:043d\:044b\:0435", " ", "\:0438", 
     " ", "\:0433\:0440\:0430\:043d\:0438\:0447\:043d\:044b\:0435", " ", 
     "\:0443\:0441\:043b\:043e\:0432\:0438\:044f"}], "\n", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ibcs", ":=", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", "in"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"0", ",", "x"}], "]"}], "==", 
        RowBox[{"ip", "*", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"0.1", "<", "x", "<", "0.3"}], ",", 
           FractionBox["0.7", "0.001"], ",", "1"}], "]"}]}]}]}], "}"}]}], 
    ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"rep", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"m", "[", 
        RowBox[{"t", ",", "x"}], "]"}], "->", 
       RowBox[{"1", "-", 
        RowBox[{"n", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "-", 
        RowBox[{"p", "[", 
         RowBox[{"t", ",", "x"}], "]"}]}]}], "}"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.8441516447084026`*^9, 3.844151740005354*^9}, {
   3.8441517942282395`*^9, 3.8441518582567806`*^9}, {3.844151933633975*^9, 
   3.844152001675456*^9}, {3.844152702739808*^9, 3.8441527136527176`*^9}, {
   3.844153132306576*^9, 3.844153241886967*^9}, {3.844153405712204*^9, 
   3.844153414523074*^9}, {3.8441535557855825`*^9, 3.84415356916829*^9}, {
   3.8441536419181623`*^9, 3.844153657927006*^9}, {3.8441537394368625`*^9, 
   3.844153765590272*^9}, {3.844153798271184*^9, 3.8441538062030244`*^9}, {
   3.8441545011224375`*^9, 3.844154503500208*^9}, {3.844155254331589*^9, 
   3.844155348478991*^9}, {3.844155450847679*^9, 3.8441554655408792`*^9}, {
   3.8441556907328053`*^9, 3.8441556916000967`*^9}, {3.8441559325379972`*^9, 
   3.844155939599998*^9}, {3.8441572877614183`*^9, 3.844157305652033*^9}, {
   3.8441574199765987`*^9, 3.8441574218420973`*^9}, {3.8441576856842813`*^9, 
   3.844157691976147*^9}, {3.8441580493396187`*^9, 3.8441580670639453`*^9}, {
   3.8441585637244005`*^9, 3.8441585652438855`*^9}, {3.8441594023809247`*^9, 
   3.8441594046819835`*^9}, {3.84415945625525*^9, 3.844159467661612*^9}, {
   3.844159686167963*^9, 3.844159697040452*^9}, {3.8441599891192994`*^9, 
   3.844159990561455*^9}, 3.8441601041015882`*^9, {3.8441601837532973`*^9, 
   3.8441601850831556`*^9}, {3.8441602878411665`*^9, 
   3.8441602979636283`*^9}, {3.844160455856391*^9, 3.8441604700595026`*^9}, {
   3.8441620264762816`*^9, 3.8441620314634633`*^9}, {3.844162618903128*^9, 
   3.8441626228565836`*^9}, {3.8442171138032417`*^9, 
   3.8442171373443594`*^9}, {3.8442172362868347`*^9, 3.844217272220821*^9}, 
   3.844217343014304*^9, {3.8442174224269505`*^9, 3.8442174243142123`*^9}, {
   3.8442174627155714`*^9, 3.844217486922844*^9}, 3.8442177078673334`*^9, 
   3.844230798325946*^9, {3.8442309180401583`*^9, 3.8442309480360775`*^9}, {
   3.844231203850226*^9, 3.8442312484870462`*^9}, {3.8442314252212925`*^9, 
   3.8442315345068426`*^9}, {3.844231605940672*^9, 3.8442316124155016`*^9}, {
   3.8442321204198384`*^9, 3.844232175852377*^9}, {3.844232767131933*^9, 
   3.844232810480827*^9}, 3.844232846824963*^9, {3.844233239237851*^9, 
   3.844233241438548*^9}, {3.844233747865287*^9, 3.8442337972403765`*^9}, {
   3.8442338376908236`*^9, 3.8442338573417516`*^9}, {3.8442338901917467`*^9, 
   3.844233918395919*^9}, {3.8442339725805597`*^9, 3.844234033370245*^9}, 
   3.844234087437524*^9, {3.845264203728348*^9, 3.8452642116238265`*^9}, {
   3.845264326054715*^9, 3.845264349625541*^9}, {3.845264464869443*^9, 
   3.845264559150132*^9}, {3.8452646005345497`*^9, 3.8452646296164737`*^9}, {
   3.8452648959157343`*^9, 3.8452649116746187`*^9}, {3.8452649529189177`*^9, 
   3.8452649560661592`*^9}, {3.8452649910039687`*^9, 3.845265007572871*^9}, {
   3.8452650377708015`*^9, 3.8452650971975865`*^9}, {3.8452651370405755`*^9, 
   3.845265143943536*^9}, {3.845265174446253*^9, 3.845265241526698*^9}, {
   3.8452655591645746`*^9, 3.8452655738410044`*^9}, 3.845265785848256*^9, {
   3.8452813621951976`*^9, 3.845281443536725*^9}, {3.845281479267917*^9, 
   3.8452814865213423`*^9}, {3.845289357027764*^9, 3.845289372854889*^9}, {
   3.84528991934149*^9, 3.8452899436372986`*^9}, {3.845290543562756*^9, 
   3.845290568373918*^9}, {3.8452916038022795`*^9, 3.8452916051769543`*^9}, {
   3.8453703497149105`*^9, 3.8453703797332797`*^9}, {3.8453704105066223`*^9, 
   3.8453705265330315`*^9}, {3.845370695493252*^9, 3.8453707305300093`*^9}, {
   3.8453708170192003`*^9, 3.845370835900154*^9}, {3.8453710659251995`*^9, 
   3.845371069081192*^9}, 3.845371143085084*^9, 3.845371805060266*^9, {
   3.845543797207446*^9, 3.8455438007025213`*^9}, {3.845544051456147*^9, 
   3.8455440535824537`*^9}, {3.845544097995869*^9, 3.8455441267376037`*^9}, {
   3.8455441923346586`*^9, 3.8455442371861258`*^9}, {3.8455447379812446`*^9, 
   3.845544906555503*^9}, {3.845544940895547*^9, 3.8455449415133505`*^9}, {
   3.845546029683967*^9, 3.845546035280216*^9}, {3.8455461871061983`*^9, 
   3.84554619526683*^9}, 3.8455463235558224`*^9, {3.845546593475794*^9, 
   3.8455465981972995`*^9}, {3.8455468570237417`*^9, 3.845546857304643*^9}, 
   3.845547398295624*^9, {3.84554768075179*^9, 3.8455479095291796`*^9}, {
   3.845548014413178*^9, 3.8455480199937744`*^9}, {3.845548192798218*^9, 
   3.8455482130987463`*^9}, {3.8455604756723995`*^9, 
   3.8455604772765226`*^9}, {3.8455606343081293`*^9, 
   3.8455606559247403`*^9}, {3.8455626187861757`*^9, 3.845562701576125*^9}, 
   3.845562735292063*^9, {3.846854688820548*^9, 3.846854689583304*^9}, {
   3.8468593086368346`*^9, 3.846859344133829*^9}, 3.846859374365644*^9, {
   3.8468594976254663`*^9, 3.846859531090585*^9}, 3.8468596166205378`*^9, {
   3.8534195081561546`*^9, 3.853419516882375*^9}, {3.8534195977482643`*^9, 
   3.8534197087509356`*^9}, {3.8534198807354827`*^9, 
   3.8534198845192747`*^9}, {3.8534199466987896`*^9, 
   3.8534199844367456`*^9}, {3.853420255679782*^9, 3.8534203083483715`*^9}, {
   3.853420377714816*^9, 3.853420413768709*^9}, {3.8534204512349434`*^9, 
   3.8534205102867947`*^9}, {3.8534205657743464`*^9, 3.853420591110474*^9}, {
   3.8534206300887475`*^9, 3.8534206728641725`*^9}, {3.8534207400426025`*^9, 
   3.8534207541034346`*^9}, 3.853421399037701*^9, {3.8534214573582163`*^9, 
   3.853421485873469*^9}, {3.853422482499691*^9, 3.8534225365620556`*^9}, {
   3.8534225863236837`*^9, 3.853422607591778*^9}, {3.8534226818968363`*^9, 
   3.8534227213201513`*^9}, {3.8534243247604456`*^9, 
   3.8534243251923275`*^9}, {3.853424388150219*^9, 3.8534244121355505`*^9}, {
   3.853425822076419*^9, 3.853425823992797*^9}, 3.875841158535624*^9, {
   3.875841481656229*^9, 3.8758415429996014`*^9}, {3.8758415952518687`*^9, 
   3.8758416240528865`*^9}, {3.8758448252710657`*^9, 3.87584488074934*^9}, {
   3.8758460104105167`*^9, 3.8758460105668535`*^9}, {3.875846575452821*^9, 
   3.875846582966978*^9}, {3.8758475582689714`*^9, 3.8758475609780674`*^9}, {
   3.8758480045441275`*^9, 3.875848006145071*^9}, {3.875848214708046*^9, 
   3.8758482162231884`*^9}, {3.8758484045196495`*^9, 3.875848446230487*^9}, {
   3.8760477916401978`*^9, 3.8760478254889383`*^9}, {3.876047932168683*^9, 
   3.876047959907507*^9}, {3.8760489007344203`*^9, 3.8760489027470713`*^9}, {
   3.8760489459995155`*^9, 3.876048947645839*^9}, {3.8760489828208694`*^9, 
   3.87604898880926*^9}, {3.8762785201406384`*^9, 3.8762785246803207`*^9}, {
   3.8762786863776827`*^9, 3.876278699509816*^9}, {3.876278810945986*^9, 
   3.8762789040009313`*^9}, {3.876278966584999*^9, 3.876278997307042*^9}, {
   3.8762795047514176`*^9, 3.876279539455806*^9}, {3.87627959120702*^9, 
   3.876279607673106*^9}, {3.8762801618428116`*^9, 3.8762801630157194`*^9}, {
   3.876283584273612*^9, 3.876283601943612*^9}, {3.876283783253763*^9, 
   3.876283857712264*^9}, {3.8762838975161114`*^9, 3.8762839048797665`*^9}, {
   3.876360771877299*^9, 3.8763608043524995`*^9}, {3.8763608562791615`*^9, 
   3.8763608602832394`*^9}, {3.876361018497322*^9, 3.8763610425922594`*^9}, {
   3.876361108719644*^9, 3.876361112869792*^9}, {3.8763616348785915`*^9, 
   3.876361636773588*^9}, {3.8763617807251377`*^9, 3.876361803028966*^9}, {
   3.876361878632057*^9, 3.8763618846824293`*^9}, {3.876361940592946*^9, 
   3.8763619865986295`*^9}, {3.876362183481634*^9, 3.876362195672015*^9}, {
   3.8763622768492002`*^9, 3.876362279553138*^9}, {3.876362319152155*^9, 
   3.8763623319478607`*^9}, {3.876362386150631*^9, 3.8763623903316803`*^9}, {
   3.87636313584859*^9, 3.87636314918606*^9}, {3.876363381160063*^9, 
   3.8763633887487*^9}, {3.876465874917323*^9, 3.876465893964382*^9}, {
   3.8764659402952576`*^9, 3.87646595254316*^9}, {3.876466000108879*^9, 
   3.8764660239677343`*^9}, {3.876467923036414*^9, 3.876467934566374*^9}, {
   3.876469534985363*^9, 3.8764696629028215`*^9}, {3.8764697351731033`*^9, 
   3.8764698281750946`*^9}, {3.87646993291413*^9, 3.8764699456531935`*^9}},
 CellLabel->
  "In[189]:=",ExpressionUUID->"20c399bc-8c4e-4b22-8ffd-15af0b5abbdc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0420\:0435\:0448\:0435\:043d\:0438\:0435", "Subsection",
 CellChangeTimes->{{3.8535765504297523`*^9, 3.853576553936266*^9}, {
  3.8535833822132807`*^9, 
  3.853583383543857*^9}},ExpressionUUID->"ea223d79-41ec-4c6b-8e9a-\
67ea1b48182e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pde", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eq", "/.", "fluxes"}], "/.", "rate"}], "/.", "bound"}], "/.", 
     "consts"}], "/.", "rep"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pde", "=", 
    RowBox[{"Activate", "[", 
     RowBox[{"pde", ",", "D"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solPDE", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Activate", "[", 
       RowBox[{"pde", "\[Union]", "ibcs"}], "]"}], "//", "N"}], "//", 
     "FullSimplify"}], "//", "Expand"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"solPDE", "//", "TableForm"}], "//", "TraditionalForm"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQPS8jdeGVrW8cN/GtA9N9eV/DFLa9cXz1VD0cRLM9
+bn+wfY3jjxPpDeAaHvdVaHvgXRDXUkYiE4x/vB42oM3jlOaAp6AaC4Gvxcg
+sOxHW9AdMyDoK8getWx22D6yJF91tOBdJ2WkBeInrtRbxOI1gw/uwVE1yg1
7AbRakxce0G0hNCktyBaSezkexCtIMT7Fyy/OfU/iD4W7MoyA0invK5lB9Hr
/f6JgOjgn2aiIHrdouPJ84D0wgkFKSC6ieeF3lmQ/euz9UE0kyxL3k8g3bOp
pQBEqxSoTQXRab1cs0G01Hqupl9A+lrnJDDN5squmPXwjeOaIhMwDQCwZLg7

  "],
 CellLabel->
  "In[194]:=",ExpressionUUID->"c5c553c5-0174-408a-bfda-c6989f69c87b"],

Cell[BoxData[
 FormBox[
  TagBox[
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{"n", "(", 
         RowBox[{"0.`", ",", "x"}], ")"}], "\[LongEqual]", "0.2`"}]},
      {
       RowBox[{
        RowBox[{"p", "(", 
         RowBox[{"0.`", ",", "x"}], ")"}], "\[LongEqual]", 
        RowBox[{"0.001`", " ", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"0.1`", "<", "x", "<", "0.3`"}], ",", 
           RowBox[{"0.7`", " ", "1000.`"}], ",", "1.`"}], "]"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"0.03846153846153846`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "1"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"0.005000000000000001`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"0.01`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"0.01`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"1.`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"0.03846153846153846`", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}], "2"]}], "+", 
         RowBox[{"0.005000000000000001`", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"0.01`", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}]}], "\[LongEqual]", 
        RowBox[{"NeumannValue", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            SuperscriptBox["\[ExponentialE]", 
             RowBox[{
              RowBox[{"-", "7.692307692307692`"}], " ", 
              RowBox[{"p", "(", 
               RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0.010000000000000002`", " ", 
               RowBox[{"p", "(", 
                RowBox[{"t", ",", "x"}], ")"}]}], "-", 
              RowBox[{"0.000049999999999999996`", " ", 
               RowBox[{"n", "(", 
                RowBox[{"t", ",", "x"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"0.09990000000000002`", " ", 
            RowBox[{"n", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}], "-", 
           RowBox[{"0.020000000000000004`", " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}], "+", "0.020000000000000004`"}],
           ",", 
          RowBox[{"x", "\[LongEqual]", "0"}]}], "]"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"0.030769230769230764`", " ", 
           RowBox[{
            SuperscriptBox["n", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}], " ", 
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "7.692307692307692`"}], " ", 
             RowBox[{"p", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
           RowBox[{"p", "(", 
            RowBox[{"t", ",", "x"}], ")"}], " ", 
           RowBox[{
            SuperscriptBox["p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}]}]}], "+", 
         RowBox[{"0.004`", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"0.030769230769230764`", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}], "2"]}], "-", 
         RowBox[{"0.004`", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"0.007692307692307693`", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          SuperscriptBox[
           RowBox[{
            SuperscriptBox["p", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "1"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}], "2"]}], "-", 
         RowBox[{"0.001`", " ", 
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{
            RowBox[{"-", "7.692307692307692`"}], " ", 
            RowBox[{"p", "(", 
             RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"1.`", " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}]}], "\[LongEqual]", 
        RowBox[{"NeumannValue", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox["\[ExponentialE]", 
            RowBox[{
             RowBox[{"-", "7.692307692307692`"}], " ", 
             RowBox[{"p", "(", 
              RowBox[{"t", ",", "x"}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"0.00004`", " ", 
              RowBox[{"n", "(", 
               RowBox[{"t", ",", "x"}], ")"}]}], "-", 
             RowBox[{"0.018000000000000002`", " ", 
              RowBox[{"p", "(", 
               RowBox[{"t", ",", "x"}], ")"}]}], "+", "0.00001`"}], ")"}]}], 
          ",", 
          RowBox[{"x", "\[LongEqual]", "0"}]}], "]"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.8762837368031273`*^9, 3.876283909853362*^9, 3.876284056232255*^9, 
   3.87636086562641*^9, 3.8763610478318477`*^9, 3.8763611196649966`*^9, 
   3.876361675336344*^9, {3.8763618153883686`*^9, 3.876361815654808*^9}, 
   3.8763618901072454`*^9, 3.876361967135075*^9, 3.8763620293706303`*^9, 
   3.8763622003739557`*^9, 3.876362240927164*^9, {3.8763623436696434`*^9, 
   3.876362348146223*^9}, 3.8763623990151076`*^9, {3.8763631648551507`*^9, 
   3.8763631651941476`*^9}, {3.876363404198284*^9, 3.8763634086751933`*^9}, {
   3.8764656757152276`*^9, 3.8764656758987236`*^9}, 3.8764657258942533`*^9, 
   3.8764658971549544`*^9, {3.876465961295*^9, 3.876465961503059*^9}, {
   3.8764660366436186`*^9, 3.8764660368109665`*^9}, {3.876466321494875*^9, 
   3.876466321674941*^9}, {3.8764674539607334`*^9, 3.8764674542458158`*^9}, {
   3.876467559741087*^9, 3.8764675610856285`*^9}, {3.8764676076210146`*^9, 
   3.8764676133026037`*^9}, {3.876468518303695*^9, 3.8764685188209934`*^9}, {
   3.876469650149501*^9, 3.87646966868099*^9}, {3.876469738787504*^9, 
   3.876469833010606*^9}, 3.8764699530890975`*^9, 3.876470007582236*^9, 
   3.876470046507264*^9},
 CellLabel->
  "Out[197]//TraditionalForm=",ExpressionUUID->"3c59f0cc-4d01-4d69-9ca2-\
3c319c091a8b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"solve", ":=", " ", 
  RowBox[{"NDSolve", "[", "\[IndentingNewLine]", 
   RowBox[{"solPDE", ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"n", ",", "p"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0.", ",", "tmax"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"x", ",", "xmin", ",", "xmax"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"EvaluationMonitor", " ", ":>", " ", 
     RowBox[{"Sow", "[", 
      RowBox[{"step", " ", "=", " ", "t"}], "]"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"AccuracyGoal", "->", "20"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MaxStepSize", "->", 
     RowBox[{"1.", " ", 
      RowBox[{"10", "^", 
       RowBox[{"-", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Method", "->", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"\"\<PDEDiscretization\>\"", "->", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<SpatialDiscretization\>\"", "->", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\"\<FiniteElement\>\"", ",", "\[IndentingNewLine]", 
            RowBox[{"\"\<MeshOptions\>\"", "->", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<MaxCellMeasure\>\"", "->", "0.01"}], ",", 
               RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", "1"}]}], "}"}]}]}], 
           "}"}]}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\n", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.8441595255903115`*^9, 3.8441599587668667`*^9, {3.8441602075228224`*^9, 
   3.8441602090258904`*^9}, {3.8441602431362677`*^9, 3.8441602490413923`*^9}, 
   3.84416096344282*^9, {3.844161584606248*^9, 3.844161584903104*^9}, {
   3.844217768093526*^9, 3.8442177962079287`*^9}, {3.8442178411463184`*^9, 
   3.844217842144174*^9}, {3.8442306851142664`*^9, 3.844230719563306*^9}, 
   3.8442310016013927`*^9, {3.844232208334203*^9, 3.844232208521701*^9}, {
   3.8442323770899467`*^9, 3.8442323912603416`*^9}, {3.8442325219276023`*^9, 
   3.844232526969754*^9}, {3.844232672786118*^9, 3.844232678159299*^9}, {
   3.84423411394132*^9, 3.844234115510618*^9}, {3.8452903678741646`*^9, 
   3.8452904310993986`*^9}, {3.845291652887987*^9, 3.845291687264123*^9}, {
   3.8452922349881163`*^9, 3.845292238627881*^9}, {3.845370956416661*^9, 
   3.845370957680255*^9}, {3.845371092987539*^9, 3.845371098507785*^9}, {
   3.8453716883746605`*^9, 3.8453716916775985`*^9}, {3.845371748019557*^9, 
   3.845371748998247*^9}, {3.8453717871899986`*^9, 3.845371792096405*^9}, 
   3.8453719012067924`*^9, 3.8453729583691096`*^9, {3.845373060393694*^9, 
   3.845373076842431*^9}, 3.8453731095459414`*^9, {3.845373305585*^9, 
   3.845373306765608*^9}, {3.8453735833582897`*^9, 3.8453735872140517`*^9}, {
   3.845540643169849*^9, 3.8455406465267773`*^9}, {3.845544403132885*^9, 
   3.8455444040106163`*^9}, {3.845544548324998*^9, 3.8455445885732045`*^9}, {
   3.845545869233794*^9, 3.8455458760387893`*^9}, {3.8455459242373295`*^9, 
   3.845545943558092*^9}, 3.845547144670746*^9, {3.845560711610548*^9, 
   3.845560722838893*^9}, {3.845560766260993*^9, 3.845560766470911*^9}, {
   3.8455609305070486`*^9, 3.84556094210165*^9}, 3.8455629039186387`*^9, {
   3.84556540963772*^9, 3.845565418527604*^9}, {3.8455655634261065`*^9, 
   3.8455655750657616`*^9}, 3.84556567690246*^9, {3.84556576037292*^9, 
   3.8455658128997936`*^9}, {3.845654164840972*^9, 3.845654170561569*^9}, {
   3.845654235848553*^9, 3.845654262751742*^9}, 3.8457242423848295`*^9, {
   3.845724312045394*^9, 3.8457243306905336`*^9}, {3.845724392070998*^9, 
   3.845724423566846*^9}, {3.8457245247624674`*^9, 3.8457245261840096`*^9}, {
   3.8457245974989133`*^9, 3.8457245977174606`*^9}, {3.8457246306143637`*^9, 
   3.8457246411666074`*^9}, {3.846781354601492*^9, 3.8467814083146486`*^9}, 
   3.8467814432468424`*^9, {3.846781488379295*^9, 3.8467815186661606`*^9}, {
   3.8467815523513827`*^9, 3.846781587560015*^9}, 3.8467816237117577`*^9, {
   3.8467816824778037`*^9, 3.8467816852679386`*^9}, {3.8467817643950377`*^9, 
   3.8467817817049847`*^9}, {3.8467818458535223`*^9, 3.846781856746137*^9}, 
   3.846781940455502*^9, 3.8467819920394974`*^9, {3.8467828205906687`*^9, 
   3.846782844068635*^9}, 3.8467828867240343`*^9, {3.8467829269152145`*^9, 
   3.8467829310058985`*^9}, {3.846783154466016*^9, 3.8467831588681383`*^9}, {
   3.846783482539255*^9, 3.8467835115270977`*^9}, {3.8468285982226877`*^9, 
   3.8468286032082424`*^9}, 3.8468291057621136`*^9, {3.8468321784511967`*^9, 
   3.846832182518304*^9}, 3.8468326016096067`*^9, 3.846834066500222*^9, 
   3.8468341881776495`*^9, {3.8468342607427273`*^9, 3.8468342650961757`*^9}, {
   3.8468348978333435`*^9, 3.846834911561966*^9}, {3.8468367202184925`*^9, 
   3.8468367231217227`*^9}, {3.8468370668904266`*^9, 
   3.8468370673558235`*^9}, {3.8468371056485057`*^9, 
   3.8468371066161976`*^9}, {3.8468371424795675`*^9, 3.846837186477436*^9}, {
   3.846837241579733*^9, 3.8468372434746695`*^9}, {3.8468372798157797`*^9, 
   3.846837284385572*^9}, {3.8468373555757647`*^9, 3.846837368082674*^9}, 
   3.84685153015162*^9, {3.846851708723897*^9, 3.8468517100466104`*^9}, 
   3.846851862721117*^9, {3.8468530832121005`*^9, 3.8468530861024647`*^9}, {
   3.8468531358526125`*^9, 3.8468531383524256`*^9}, {3.846853287058585*^9, 
   3.846853287746027*^9}, 3.8468534113137703`*^9, {3.8468541583710155`*^9, 
   3.8468541603963675`*^9}, {3.8468543179822416`*^9, 3.84685432022955*^9}, {
   3.853419406360295*^9, 3.8534194098461847`*^9}, {3.853419470899886*^9, 
   3.853419472177483*^9}, {3.8534199959380393`*^9, 3.853420012557871*^9}, 
   3.8534206866356916`*^9, {3.853420988608971*^9, 3.8534209940547266`*^9}, 
   3.8534213570661163`*^9, {3.8534216185799212`*^9, 3.8534217685526724`*^9}, 
   3.853421803307165*^9, {3.8534220005783834`*^9, 3.8534220155835834`*^9}, {
   3.853422337766043*^9, 3.85342234322865*^9}, {3.853422662545843*^9, 
   3.8534226685029693`*^9}, {3.8534227428922367`*^9, 
   3.8534227633562956`*^9}, {3.853422853920974*^9, 3.853422880507762*^9}, {
   3.853424013955507*^9, 3.8534240189409266`*^9}, {3.8534279070630765`*^9, 
   3.8534279163081117`*^9}, 3.8534280295838976`*^9, {3.8534280900555534`*^9, 
   3.85342809419424*^9}, {3.853428129275377*^9, 3.853428131774579*^9}, {
   3.8535753672776103`*^9, 3.853575374007042*^9}, {3.8535826594548883`*^9, 
   3.8535827165766354`*^9}, {3.853582914268876*^9, 3.853582914471839*^9}, {
   3.8535829970773373`*^9, 3.8535830779221377`*^9}, {3.8544594177167006`*^9, 
   3.8544594574570827`*^9}, {3.854459513508576*^9, 3.854459517201195*^9}, 
   3.85445970600935*^9, {3.854500100663786*^9, 3.85450012583435*^9}, {
   3.854531213801547*^9, 3.8545312240964136`*^9}, 3.8545313539214883`*^9, {
   3.8758435732553663`*^9, 3.8758435892084427`*^9}, {3.8758440078300943`*^9, 
   3.8758440078955884`*^9}, {3.8758477207483835`*^9, 3.87584772929815*^9}, {
   3.875847762502293*^9, 3.875847762621537*^9}, {3.8758479642281265`*^9, 
   3.8758479714332275`*^9}, {3.875848340863619*^9, 3.8758483445192003`*^9}, {
   3.8758614473157873`*^9, 3.8758614482017684`*^9}, {3.875867218436098*^9, 
   3.8758672551878424`*^9}, {3.875867677714712*^9, 3.875867678396287*^9}, {
   3.8758679041533747`*^9, 3.8758679055912046`*^9}, {3.875868903942526*^9, 
   3.875868925330924*^9}, {3.875868962241352*^9, 3.875868963120801*^9}, {
   3.8759557581597605`*^9, 3.875955811849511*^9}, {3.8759561730580044`*^9, 
   3.8759562149803157`*^9}, 3.8759582223298407`*^9, {3.875958259169664*^9, 
   3.8759582819106874`*^9}, {3.8759586518167763`*^9, 3.87595868543472*^9}, {
   3.875960754026477*^9, 3.875960796619937*^9}, {3.8759616347289867`*^9, 
   3.875961670688957*^9}, {3.875961724090206*^9, 3.875961765705365*^9}, {
   3.875961902148938*^9, 3.8759619167955647`*^9}, {3.8759619559378605`*^9, 
   3.8759620518235116`*^9}, 3.875962085049151*^9, {3.875962182464856*^9, 
   3.87596224311806*^9}, {3.875962368682892*^9, 3.8759623737452836`*^9}, {
   3.875962477835335*^9, 3.8759625094266844`*^9}, 3.8759625452055216`*^9, {
   3.875962786082956*^9, 3.8759628144764934`*^9}, {3.8760442526268196`*^9, 
   3.8760442529391503`*^9}, {3.876046107001224*^9, 3.876046107396095*^9}, {
   3.8760461691947465`*^9, 3.8760461696585484`*^9}, {3.8760481037788296`*^9, 
   3.8760481048503103`*^9}, {3.8762796586603675`*^9, 3.876279659138731*^9}, {
   3.876280180518306*^9, 3.876280180636554*^9}, {3.8763616681455836`*^9, 
   3.876361668897614*^9}, {3.8763616990948086`*^9, 3.8763617346558013`*^9}, {
   3.876466496284644*^9, 3.8764664968112345`*^9}, 3.8764675494447827`*^9},
 CellLabel->
  "In[198]:=",ExpressionUUID->"05c5453f-f7f6-480c-b030-1a1570d52aaf"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Method", "->", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{"\"\<PDEDiscretization\>\"", "->", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{"\"\<MethodOfLines\>\"", ",", "\[IndentingNewLine]", 
      RowBox[{"\"\<SpatialDiscretization\>\"", "->", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\"\<FiniteElement\>\"", ",", "\[IndentingNewLine]", 
         RowBox[{"\"\<MeshOptions\>\"", "->", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\"\<MaxCellMeasure\>\"", "->", "0.001"}], ",", 
            RowBox[{"\"\<MeshOrder\>\"", "\[Rule]", "2"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"\"\<IntegrationOrder\>\"", "->", "2"}]}], "}"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", "}"}]}]], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"1b32f10d-2e36-4e24-b9b1-4c36f1aa0000"],

Cell[BoxData[
 RowBox[{"Method", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{"\<\"PDEDiscretization\"\>", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\<\"MethodOfLines\"\>", ",", 
      RowBox[{"\<\"SpatialDiscretization\"\>", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\<\"FiniteElement\"\>", ",", 
         RowBox[{"\<\"MeshOptions\"\>", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\<\"MaxCellMeasure\"\>", "\[Rule]", "0.001`"}], ",", 
            RowBox[{"\<\"MeshOrder\"\>", "\[Rule]", "2"}]}], "}"}]}], ",", 
         RowBox[{"\<\"IntegrationOrder\"\>", "\[Rule]", "2"}]}], "}"}]}]}], 
     "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.876361815715822*^9, 3.876362348200203*^9, 
  3.8763631652491493`*^9, 3.8763634087295027`*^9, 3.8764656760071154`*^9, 
  3.8764658972051306`*^9, 3.8764659615320272`*^9, 3.8764660368419647`*^9, 
  3.8764663217189145`*^9, 3.876467454302307*^9, 3.8764675612736297`*^9, 
  3.876467613362781*^9, 3.876468518904993*^9, 3.876469655780761*^9},
 CellLabel->"Out[37]=",ExpressionUUID->"d1643650-8f9e-4958-a3cd-1b9fbee9c579"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eq", "/.", "fluxes"}], "/.", "rep"}], "//", "Activate"}], "//",
      "FullSimplify"}], "//", "Expand"}], "//", "TableForm"}], "//", 
  "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.876049416980692*^9, 3.876049419493002*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"48a7f7bf-265a-4270-9579-d6e9a9211968"],

Cell[BoxData[
 FormBox[
  TagBox[
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"ANM", " ", 
           RowBox[{
            SuperscriptBox["n", 
             TagBox[
              RowBox[{"(", 
               RowBox[{"0", ",", "2"}], ")"}],
              Derivative],
             MultilineFunction->None], "(", 
            RowBox[{"t", ",", "x"}], ")"}], " ", 
           RowBox[{"p", "(", 
            RowBox[{"t", ",", "x"}], ")"}]}]}], "+", 
         RowBox[{"ANM", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"ANM", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"ENP", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"ENP", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", "\[CapitalGamma]n"}], 
        "\[LongEqual]", 
        RowBox[{
         SuperscriptBox["n", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "(", 
         RowBox[{"t", ",", "x"}], ")"}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"BPM", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"BPM", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"BPM", " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "-", 
         RowBox[{"ENP", " ", 
          RowBox[{
           SuperscriptBox["n", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{"p", "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", 
         RowBox[{"ENP", " ", 
          RowBox[{"n", "(", 
           RowBox[{"t", ",", "x"}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["p", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"0", ",", "2"}], ")"}],
             Derivative],
            MultilineFunction->None], "(", 
           RowBox[{"t", ",", "x"}], ")"}]}], "+", "\[CapitalGamma]p"}], 
        "\[LongEqual]", 
        RowBox[{
         SuperscriptBox["p", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "(", 
         RowBox[{"t", ",", "x"}], ")"}]}]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.8760490015254817`*^9, {3.876049032189595*^9, 3.8760490607704053`*^9}, 
   3.8760494220801606`*^9, 3.876050137977429*^9, {3.876050697132506*^9, 
   3.8760507142339883`*^9}, 3.8760509857574635`*^9, 3.876051065465556*^9, {
   3.876051153294307*^9, 3.8760511645169363`*^9}, 3.8762781761020217`*^9, 
   3.8762785637047048`*^9, 3.876278756906986*^9, 3.8762789489971676`*^9, 
   3.876279542144763*^9, 3.8762796350072145`*^9, 3.876279690141897*^9, 
   3.876280255583805*^9, 3.8762836584895296`*^9, 3.8762839173191023`*^9, 
   3.87636087050222*^9, 3.876361816898923*^9, 3.8763620328656*^9, 
   3.876362348399218*^9, 3.87636316549115*^9, 3.8763634089315176`*^9, 
   3.8764656761842422`*^9, 3.876465897370129*^9, 3.876465961698052*^9, 
   3.8764660370099697`*^9, 3.8764663218849416`*^9, 3.876467454514304*^9, 
   3.876467561617637*^9, 3.8764676135747433`*^9, 3.8764685191529856`*^9, 
   3.876469656204813*^9},
 CellLabel->
  "Out[38]//TraditionalForm=",ExpressionUUID->"874df7ee-1afb-40b0-91e9-\
bd63d6c340c3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[CapitalGamma]n", ",", "\[CapitalGamma]p"}], "}"}], "/.", 
         "bound"}], "/.", "rep"}], "/.", "consts"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"n", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "->", "0.3"}], ",", 
        RowBox[{
         RowBox[{"p", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "->", "0.1"}]}], " ", "}"}]}], "//",
      "FullSimplify"}], "//", "Expand"}], "//", "TableForm"}], "//", 
  "TraditionalForm"}]], "Input",
 CellChangeTimes->{{3.876279085885401*^9, 3.876279138113949*^9}, {
   3.8762792881472216`*^9, 3.8762793309383645`*^9}, 3.8762841144763217`*^9, {
   3.876284289187539*^9, 3.8762843156001043`*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"9908fe38-df0f-44dc-993c-022a9d2c1ad2"],

Cell[BoxData[
 FormBox[
  TagBox[
   TagBox[GridBox[{
      {
       RowBox[{"NeumannValue", "[", 
        RowBox[{
         RowBox[{"-", "0.11878716234261459`"}], ",", 
         RowBox[{"x", "\[LongEqual]", "0"}]}], "]"}]},
      {
       RowBox[{"NeumannValue", "[", 
        RowBox[{
         RowBox[{"-", "0.004587356755388636`"}], ",", 
         RowBox[{"x", "\[LongEqual]", "0"}]}], "]"}]}
     },
     GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column],
   Function[BoxForm`e$, 
    TableForm[BoxForm`e$]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.8762791001203966`*^9, 3.8762791550982547`*^9}, {
   3.8762793092865677`*^9, 3.8762793317683983`*^9}, 3.8762795436206217`*^9, 
   3.8762796363592405`*^9, 3.8762796901678944`*^9, 3.8762802556108046`*^9, 
   3.8762836585035405`*^9, 3.876283918711187*^9, 3.876284115121447*^9, {
   3.8762842978718777`*^9, 3.8762843160045986`*^9}, 3.8763608725820093`*^9, 
   3.876361817028924*^9, 3.8763620343503847`*^9, 3.876362206055543*^9, 
   3.876362348439044*^9, 3.8763631655331507`*^9, 3.8763634089616537`*^9, 
   3.8764656762112193`*^9, 3.876465897399129*^9, 3.8764659617270613`*^9, 
   3.8764660370369444`*^9, 3.876466321911256*^9, 3.876467454554691*^9, 
   3.876467561657634*^9, 3.876467613607532*^9, 3.876468519177059*^9, 
   3.876469656245123*^9},
 CellLabel->
  "Out[39]//TraditionalForm=",ExpressionUUID->"c7611e81-0f3f-4ff3-bba2-\
6e2bc11b7a36"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\:0413\:0440\:0430\:0444\:0438\:043a\:0438", "Subsection",
 CellChangeTimes->{{3.8534273637107754`*^9, 
  3.853427369811845*^9}},ExpressionUUID->"4c191423-193d-40d9-8500-\
6d7e7b79cd09"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mon", "[", 
  RowBox[{"Hold", "[", 
   RowBox[{"solution", "=", "solve"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.8468322443606043`*^9, 3.84683226157753*^9}, {
   3.8468341048381057`*^9, 3.846834130053505*^9}, {3.846834433945793*^9, 
   3.846834447841956*^9}, {3.846834486092134*^9, 3.8468344916198664`*^9}, {
   3.846834708247772*^9, 3.8468347287371163`*^9}, {3.8468349216507196`*^9, 
   3.8468349223754883`*^9}, {3.8468541731642447`*^9, 3.846854181701511*^9}, 
   3.846854215104845*^9, {3.8534193147693605`*^9, 3.8534193169236703`*^9}, {
   3.8534194230171385`*^9, 3.8534194242727423`*^9}, {3.8534200023891244`*^9, 
   3.8534200223511767`*^9}},
 CellLabel->
  "In[199]:=",ExpressionUUID->"d61e6cdb-f0d4-4d29-bb2d-6d01e56e4a01"],

Cell[BoxData["2.578125`"], "Output",
 CellChangeTimes->{
  3.876467585408849*^9, 3.8764678544910736`*^9, 3.8764685332392664`*^9, {
   3.876469656627106*^9, 3.8764696723707275`*^9}, {3.876469817590682*^9, 
   3.876469845256812*^9}, 3.8764699582082987`*^9, 3.8764700182041845`*^9, 
   3.8764700535318623`*^9},
 CellLabel->
  "Out[199]=",ExpressionUUID->"411b1caa-026d-4ce2-b48d-5321de5f8762"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DiscretePlot", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"n", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "/.", "solution"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"p", "[", 
         RowBox[{"t", ",", "x"}], "]"}], "/.", "solution"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"1", "-", 
         RowBox[{"n", "[", 
          RowBox[{"t", ",", "x"}], "]"}], "-", 
         RowBox[{"p", "[", 
          RowBox[{"t", ",", "x"}], "]"}]}], "/.", "solution"}]}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"x", ",", "xmin", ",", "xmax", ",", 
       RowBox[{"1", "/", "100"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Joined", "->", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "0.1"}], ",", "1.1"}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Filling", "->", "None"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"500", ",", "300"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
   ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "tmax"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"ControlPlacement", "->", "Top"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.875841134464031*^9, 3.875841142717464*^9}, {
   3.8758478585203514`*^9, 3.8758479159974656`*^9}, {3.8758676980620203`*^9, 
   3.8758677285775967`*^9}, 3.8759618586200423`*^9, {3.875962500945636*^9, 
   3.8759625010567665`*^9}, 3.875962535860787*^9, {3.876042764346489*^9, 
   3.876042779562785*^9}, {3.8760428639534383`*^9, 3.8760429208560123`*^9}, 
   3.876043544156311*^9, {3.87604365956942*^9, 3.8760436774363537`*^9}, {
   3.876043780690922*^9, 3.876043781472126*^9}, {3.876043845511012*^9, 
   3.8760438750732436`*^9}, {3.876043942373179*^9, 3.8760439728276772`*^9}, {
   3.8760443898110437`*^9, 3.8760443899110413`*^9}, {3.8760456164204283`*^9, 
   3.8760456199135227`*^9}, {3.876045974133545*^9, 3.8760459887092905`*^9}},
 CellLabel->
  "In[200]:=",ExpressionUUID->"abdabfd5-d58a-4c99-91e3-17b919264931"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 5., Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 5}}, Typeset`size$$ = {550., {162., 168.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = True}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> DiscretePlot[{
         ReplaceAll[
          $CellContext`n[$CellContext`t$$, $CellContext`x], \
$CellContext`solution], 
         ReplaceAll[
          $CellContext`p[$CellContext`t$$, $CellContext`x], \
$CellContext`solution], 
         ReplaceAll[
         1 - $CellContext`n[$CellContext`t$$, $CellContext`x] - \
$CellContext`p[$CellContext`t$$, $CellContext`x], $CellContext`solution]}, \
{$CellContext`x, $CellContext`xmin, $CellContext`xmax, 1/100}, Joined -> True,
         PlotRange -> {-0.1, 1.1}, Filling -> None, ImageSize -> {500, 300}], 
      "Specifications" :> {{$CellContext`t$$, 0, 5}}, 
      "Options" :> {ControlPlacement -> Top}, "DefaultOptions" :> {}],
     ImageSizeCache->{604., {208.84743643933908`, 215.15256356066092`}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.8758616460703077`*^9, 3.8758616490128565`*^9}, 
   3.8758630758762245`*^9, {3.8758631217037387`*^9, 3.8758631222327013`*^9}, {
   3.875865212177785*^9, 3.8758652192767134`*^9}, 3.875865257750312*^9, {
   3.8758665173549204`*^9, 3.875866533660387*^9}, 3.8758666309501963`*^9, 
   3.8758666743082457`*^9, 3.8758677794336166`*^9, 3.875954788343587*^9, 
   3.8759562386908712`*^9, 3.8759569286817865`*^9, {3.8759575331594*^9, 
   3.875957541611318*^9}, {3.8759617122599187`*^9, 3.87596175649546*^9}, {
   3.8759618300539074`*^9, 3.8759618679800606`*^9}, 3.8759619223265715`*^9, {
   3.8759620266613374`*^9, 3.8759620424221177`*^9}, 3.875962230237762*^9, {
   3.875962386341901*^9, 3.875962406626675*^9}, {3.8759624855177164`*^9, 
   3.875962536828023*^9}, 3.875962570449371*^9, 3.875962895310966*^9, 
   3.876041904969654*^9, 3.8760427815582485`*^9, {3.876042869574901*^9, 
   3.876042876893076*^9}, {3.876042906919578*^9, 3.876042921243802*^9}, 
   3.8760434880959096`*^9, 3.8760435446625104`*^9, 3.876043667811117*^9, 
   3.8760437819243298`*^9, {3.876043849295683*^9, 3.876043860258238*^9}, {
   3.87604394362356*^9, 3.8760439731000013`*^9}, 3.8760443136430693`*^9, {
   3.876044374592852*^9, 3.876044390972203*^9}, 3.8760455728466787`*^9, {
   3.8760456207800894`*^9, 3.876045625743186*^9}, {3.876045960113005*^9, 
   3.8760459938232794`*^9}, {3.8760460442964816`*^9, 3.876046056226629*^9}, 
   3.876046144559141*^9, 3.8760462849358673`*^9, 3.876047767250759*^9, 
   3.8760478581288967`*^9, 3.876048025969991*^9, 3.8760490036472454`*^9, 
   3.876049034223077*^9, 3.8760490945881667`*^9, 3.8760501729749365`*^9, 
   3.876050235116708*^9, 3.8760509630000057`*^9, 3.876051018810383*^9, 
   3.876051114979189*^9, 3.876051155009707*^9, 3.8760513195822906`*^9, {
   3.876052435675988*^9, 3.8760524371056137`*^9}, 3.8760524782363696`*^9, 
   3.8762783742797413`*^9, 3.876278565407725*^9, 3.876278759053239*^9, 
   3.87627895183718*^9, 3.8762795824520736`*^9, 3.8762800363142457`*^9, 
   3.8762831290283794`*^9, 3.876283661073427*^9, 3.8763616605433307`*^9, 
   3.876361819026921*^9, 3.8763619257626514`*^9, 3.8763622282352943`*^9, 
   3.8763623647763557`*^9, 3.876362568370932*^9, 3.8763633372891684`*^9, 
   3.8763635678676376`*^9, 3.876465750833498*^9, 3.8764658299837265`*^9, 
   3.8764659212033253`*^9, 3.876465985650586*^9, 3.8764663038515263`*^9, 
   3.8764664821262407`*^9, 3.876467585614561*^9, 3.8764678546777754`*^9, {
   3.8764685334002156`*^9, 3.876468548579032*^9}, 3.8764696567520266`*^9, 
   3.8764699604323707`*^9, 3.87647002019092*^9, 3.876470054050001*^9},
 CellLabel->
  "Out[200]=",ExpressionUUID->"7854b2b8-e1c4-48d6-9369-a32af91dd2dd"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1152., 595.8},
WindowMargins->{{Automatic, -5.399999999999864}, {
  Automatic, -5.3999999999999995`}},
DockedCells->{},
TaggingRules->Association["TryRealOnly" -> False],
Magnification:>1.1 Inherited,
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (June 19, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fc2e8887-779f-4e53-8bbe-9f845063a5a9"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 243, 4, 59, "Subsection",ExpressionUUID->"a634d41f-370e-4978-b3f4-6d8a940d7378"],
Cell[826, 28, 1345, 30, 247, "Code",ExpressionUUID->"fafc50c5-8f20-4fc6-ae7d-dd73a4d177fd"]
}, Closed]],
Cell[CellGroupData[{
Cell[2208, 63, 254, 4, 41, "Subsection",ExpressionUUID->"c2571d73-d70e-40d8-9f35-bfdcc719ea43"],
Cell[2465, 69, 7971, 147, 297, "Code",ExpressionUUID->"9bb19146-52b8-4688-8de0-832643d7a09f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10473, 221, 253, 4, 59, "Subsection",ExpressionUUID->"ecdb4270-0e29-4cf8-a85f-0106df86b174"],
Cell[10729, 227, 18639, 399, 1043, "Code",ExpressionUUID->"20c399bc-8c4e-4b22-8ffd-15af0b5abbdc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29405, 631, 243, 4, 59, "Subsection",ExpressionUUID->"ea223d79-41ec-4c6b-8e9a-67ea1b48182e"],
Cell[CellGroupData[{
Cell[29673, 639, 1264, 36, 133, "Input",ExpressionUUID->"c5c553c5-0174-408a-bfda-c6989f69c87b",
 InitializationCell->True],
Cell[30940, 677, 12101, 322, 115, "Output",ExpressionUUID->"3c59f0cc-4d01-4d69-9ca2-3c319c091a8b"]
}, Open  ]],
Cell[43056, 1002, 8765, 132, 384, "Input",ExpressionUUID->"05c5453f-f7f6-480c-b030-1a1570d52aaf",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[51846, 1138, 900, 17, 199, "Input",ExpressionUUID->"1b32f10d-2e36-4e24-b9b1-4c36f1aa0000"],
Cell[52749, 1157, 1094, 21, 57, "Output",ExpressionUUID->"d1643650-8f9e-4958-a3cd-1b9fbee9c579"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53880, 1183, 416, 11, 31, "Input",ExpressionUUID->"48a7f7bf-265a-4270-9579-d6e9a9211968"],
Cell[54299, 1196, 5771, 163, 71, "Output",ExpressionUUID->"874df7ee-1afb-40b0-91e9-bd63d6c340c3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60107, 1364, 929, 25, 31, "Input",ExpressionUUID->"9908fe38-df0f-44dc-993c-022a9d2c1ad2"],
Cell[61039, 1391, 1679, 39, 67, "Output",ExpressionUUID->"c7611e81-0f3f-4ff3-bba2-6e2bc11b7a36"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[62767, 1436, 192, 3, 59, "Subsection",ExpressionUUID->"4c191423-193d-40d9-8500-6d7e7b79cd09"],
Cell[CellGroupData[{
Cell[62984, 1443, 760, 13, 31, "Input",ExpressionUUID->"d61e6cdb-f0d4-4d29-bb2d-6d01e56e4a01"],
Cell[63747, 1458, 390, 7, 35, "Output",ExpressionUUID->"411b1caa-026d-4ce2-b48d-5321de5f8762"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64174, 1470, 2392, 51, 345, "Input",ExpressionUUID->"abdabfd5-d58a-4c99-91e3-17b919264931"],
Cell[66569, 1523, 4671, 77, 444, "Output",ExpressionUUID->"7854b2b8-e1c4-48d6-9369-a32af91dd2dd"]
}, Open  ]]
}, Open  ]]
}
]
*)

